#!/usr/bin/env python
# SCsub

import os
import subprocess
from tools import helpers


Import('env')
mysql_env = env.Clone()


# Use absolut paths to avoid problem between platforms.
dep_path = os.path.join(os.getcwd(), "3party")

# Update and compile thirdparty.
helpers.apply_config(env)


sources = [
	"register_types.cpp",
	"scr/helpers.cpp",
	"scr/sql_result.cpp",
	"scr/mysql.cpp",
]


#env.Append(CPPDEFINES=[
#	"__EXCEPTIONS",
#	"BOOST_NO_EXCEPTIONS",
#	"BOOST_EXCEPTION_DISABLE",
# ])


mysql_env.Append(CPPFLAGS =[
	'-fexceptions',
	'-std=c++20',
])


# INCLUDE:
mysql_env.Prepend(CPPPATH=[
	os.path.join(dep_path, "boost"),
	os.path.join(dep_path, "boost/boost"),
	os.path.join(dep_path, "openssl"),
	os.path.join(dep_path, "openssl/include"),
])

# LIB
env.Append(LIBPATH=[
	os.path.join(dep_path, "boost/stage/lib"),
	os.path.join(dep_path, "openssl"),
	os.path.join(dep_path, "openssl/apps"),
	os.path.join(dep_path, "openssl/providers"),
])



mysql_env.add_source_files(env.modules_sources, sources)

# "libboost_system", "libboost_exception", 
env.Append(LIBS=["libssl", "libcrypto", "libboost_thread", ])
